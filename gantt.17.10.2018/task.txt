Вижу несколько причин:

 

1. Цвета. Поскольку у тебя явно синий превратился в красный и наоборот, а зелёный нормальный, но ты не переставил первый и третий байт в цветах. У меня идёт фактически BGR, а не RGB - я тебе говорил. В C++ младший адрес - младший байт.

 

2. Для фаз ты не используешь всё ещё f_LastFin, хотя для операций и назначений всё правильно.

 

3. Связи неправильно вместо Старт-Старт у тебя Финиш-Финиш. Вот пример

я тебе передал в файл

spamrd02   ww 10

0x10 - это Старт-Старт, а у тебя нарисовано ФФ

Повторю мои константы:

#define ltype_fs         0x00000000

#define ltype_ss         0x00000010

#define ltype_ff         0x00000020

#define ltype_sf         0x00000030

 

4. Бывают операции нулевой длины (контрольные события). У них старт совпадает с финишем. В таких случаях Спайдер рисует ромбик на этом моменте времени. А у тебя, естественно пусто. :-)

Например, операция с кодом spammr03.

А также остаток операции с кодом ww.

 

5. Стрелки у тебя слишком здоровые. В идеале они должны быть высотой в половину прямоугольников (ну или 2/3), но при вертикальном масштабировании пропорция должна сохраняться.

 

6. В поле уровень отображать буквы A и T не нужно. Они тебе для внутренней информации. Можешь завести какой-то внутренний признак для строки - её тип?

 

7. Надо постараться сделать заголовки колонок многосрочными - если не помещается, чтоб "рэпилось". Функция Windows API DrawText делает именно так.

 

Вот тогда будет точно, как на скриншоте у меня.

Кстати, удалось повторить, что писал ВИ - вдруг пропали почти все прямоугольники (причём несколько верхних остались) и остались только связи. По F5 всё восстановилось.

Как это опвторить - пока не понимаю. Не заметил.

 

Подтверди получение, плиз.

Костя.